<!DOCTYPE html>
<html lang="zh-CN">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>跨境优品</title>
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, width=device-width">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-touch-fullscreen" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="format-detection" content="telephone=no">
		<meta name="format-detection" content="address=no">
		<link rel="stylesheet" type="text/css" href="../../css/common.css">
		<link rel="stylesheet" type="text/css" href="../../css/index.css">
		<link rel="stylesheet" type="text/css" href="../../css/mui.min.css"/>
		<link rel="stylesheet" href="../../css/reset.css">
		<link rel="stylesheet" href="../../css/one.css">
		<script type="text/javascript" src="../../js/jquery.min.js"></script>
		<script type="text/javascript" src="../../js/artTemplate-native.js"></script>
		<script src="../../js/mui.min.js"></script> 
		<style type="text/css">
			/*banner底部导航*/
			.mui-slider-indicator .mui-indicator{
				width: 10px;
				height: 10px;
				border-radius: 8px;
				background: black;
				margin-right: 5px;
				opacity: 0.3;
				cursor: pointer;
				border: none;
				box-shadow: none;
			}
			
			#banner{
				position: relative;
				width: 100%;
				padding-top: 42%; 
				overflow: hidden;
				background: url(../../img/bannerback.svg) 50% 50% no-repeat;
				background-size: 20%;
			}
			.mui-slider .mui-slider-group{
				position: absolute;
			    height: 100%;
			    width: 100%;
			    top: 0;
			}
			.mui-slider .mui-slider-group .mui-slider-item img{height: 100%;}
			.onetable{
				margin-top: 0;
			}
			.onetable p{
				margin-top: -10px;
				font-size: 11px;
				color: #666;
				margin-bottom: 5px;
			}
			.onetable img{
				padding: 5px;
			}
			.fontcl2{
				font-size: 23px;
				line-height: 30px;
			}
			.sy_recmd_list .pub_wz{
				position: relative;
			}
			sub{
				bottom: 0;
				font-size: 50%;
				margin-left: 5px;
			}
			.fr {
				position: absolute;
				float: right;
				display: block;
				top: 12px;
				right: 5px;
				font-size: 10px;
			}
			.sy_recmd_list .pub_wz .nr_box{
				border-top: none;
			}
			.sy_recmd_list .pub_wz .nr_box{
				margin-top: 0;
			}
			.mui-bar{
				height: 50px;
			}
			.mui-title,.mui-icon{
				line-height: 50px;
			}
			.mui-bar .mui-icon{
				padding: 0;
			}
			
			
			/*这一页*/
			.onetable{
				/*padding-top: 5px;*/
				border-bottom: 0 solid #e6e6e6;
				padding-bottom: 15px;
				background-color: #fff;
			}
			.onetable table img {
				width: 45%;
				margin: 0.18rem 0;
			}
			.onetable p {
				margin-top: -16px;
				font-size: 12px;
			}
			.market-icon{
				border-radius: 50%;
				width: 0.6rem;
				height: 0.6rem;
				display: block;
				margin: 10px auto;
			}
			.icon1{
				background-color: #e64c66;
				/*background-color: #ae413c;*/
			}
			.icon2{
				background-color: #fbb150;
			}
			.icon3{
				background-color: #4fc5f7;
				/*background-color: #53a4b7;*/
			}
			.icon4{
				background-color: #10a8ab;
				/*background-color: #b16987;*/
			}
			.icon5{
				background-color: #3469af;
				/*background-color: #528e46;*/
			}
			.icon6{
				background-color: #35abdd;
				/*background-color: #be653e;*/
			}
			.icon7{
				background-color: #cc324c;
				/*background-color: #b9285f;*/
			}
			
			.icon8{
				background-color: #50587c;
				/*background-color: #ae413c;*/
			}
			.left{
				border-left: 0.03rem solid #f53c42;
				padding-left: 10px;
			}
			/*精选频道*/
			.choiceness {
				margin-top: 10px;
				padding-bottom: 5px;
			}
			.choiceness p{
				text-align: center;
				color: #333;
				line-height: 20px;
			}
			.choiceness .gray{
				color: #666;
				font-size: 11px;
			}
			.choiceness img{
				width: 16px;
			}
			 
			.box{
				border: 1px solid #efefef;
			}
			.sy_recmd{
				background-color: #fff;margin-bottom: 10px;border-bottom: 0px solid #eee;
			}
			.sy_title{
				border-bottom: none;
			}
			.mui-bar-nav{
				box-shadow: none;
			}
		 
			.imgpt{
				position: relative;
				width: 100%;
				padding-top: 65%;
				overflow: hidden;
			}
			.imgpt img{
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
			}
			.clasfyItem{
				position: absolute;
				top: 50%;
				-webkit-transform: translateY(-50%);
				left: 0;
				right: 0;
				text-align: center;
				line-height: 3;
			}
			.clasfyItem .itemName{
				color: white;
				font-size: 0.2rem;
				font-weight: 400;
			} 
			.trangle{
				position: absolute;
			    bottom: 0;
			    left: 0.2rem;
			    width: 0px;
			    height: 0px;
			    border-top: 11px solid transparent;
			    border-right: 11px solid transparent;
			    border-bottom: 11px solid white;
			    border-left: 11px solid transparent;
			}
			.npbk{
		 	    overflow-x: hidden; 
			  	width: 100vw; 
			  	
			 	position: relative;
			 	left: 50%;
			 	right: 50%;
			 	margin-left: -50vw;
			 	margin-right: -50vw;
			}
			.npbk ul{
				margin: 10px 0px 0 15px; 
				position: relative;
			}
			.npbk ul:not(:last-of-type):after{
				position: absolute;
				content: '';
				height: 1px;
				-webkit-transform: scaleY(0.3);
				background-color: #EEEEEE;
				left: 0;
				right: 0;
				bottom: 0;
				transform-origin: bottom;
			}
			.npbk ul li{
				display: inline-block;
				margin-right: 0.15rem;
				margin-bottom: 0.15rem;
			}
		 	.nplist{
		 		width: 1.3rem;
		 		/*height: 1.3rem;*/ 
		 		text-align: center;
		 		display: inline-block;
		 		margin-bottom: 10px;
		 		/*border: 1px solid #efefef;*/
				box-shadow: 0px 0 5px 0px rgba(0,0,0,0.1);
		 		margin-left: 5px;
		 	}
		 	.nplast{  
		 		height: 1.3rem;
		 		/*text-align: center;*/
		 		line-height: 1.3rem;
		 		color: #f53c42 ;
		 		border: 1px solid #eee;
		 		position: absolute;
		 		top: 0; 
		 	}
		 	.nplist h4{
		 		color: black;
		 		font-size: 0.14rem;
		 		width: 1rem;
		 		line-height:2;
			    text-overflow: ellipsis;
			    white-space: nowrap;
			    overflow: hidden;
			    margin: auto;
		 	}
		 	.npimg{
		 		position: relative;
				width: 100%;
				padding-top:100%;
				overflow: hidden;
		 	} 
		 	.npimg img{
		 		position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
		 	}
		 	.nprice{
		 		font-size: 0.12rem;
		 		color: #f53c42;
		 		line-height: 1.5;
		 	}
		 	.pagebottom{
		 		color:darkgray;
		 		position: relative;
		 		text-align: center;
		 		margin-bottom: 20px;
		 		margin-top: 10px;
		 		
		 	}
		 	.pagebottom:before{
		 		position: absolute;
		 		content: '';
		 		width: 1rem;
		 		right:15%;
		 		top: 7px;
		 		border-bottom: 1px solid #ddd;
		 		
		 	}
		 	.sy_title{
		 		border-top: 0;
		 	}
		 	.pagebottom:after{
		 		position: absolute;
		 		content: '';
		 		width: 1rem;
		 		left:15%;
		 		top: 7px;
		 		border-bottom: 1px solid #ddd;
		 		
		 	}
		 	#main{
		 		margin-top: 50px;
		 		}
		 	h4{
		 		color: #666 !important;
		 	}
		 	.itemGo{
		 		background: none;
		 		color: white;
		 		border-radius: 50px;
		 		font-size: 0.12rem;
		 		border-color: white;
		 		padding: 5px 15px;
		 	}
		</style>
	</head>
	<body>
		<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left bigSize"></a>
			<h1 class="mui-title">跨境优品</h1>
		</header>
		<script src="../../js/statusBar.js"></script><!--状态栏--> 
		<div id="main">
			<div id="scroller">
				<div id="classify"></div>
				<script type="text/html" id="classifyTpl">
					<%for(var i=0;i<list.length;i++){%>
						<div class="sy_recmd typeDis" style="background-color: #fff;" id="<%=list[i].catid%>">
							<div class="imgpt" onclick="goList(<%=list[i].catid%>)"><!-- onclick="goList(<%=list[i].catid%>)"-->
								<%if(list[i].icon){%>
									<img src="<%=myUrl%><%=list[i].icon%>" onerror="this.src='../../img/igetc1.png'" alt="" />
									<%}else{%>
										<img src="../../img/igetc1.png" alt="" />
									<%}%>
							 	<div class="clasfyItem">
							 		<div class="itemName"><%=list[i].catname%></div>
							 		<button type="button" class="mui-btn itemGo" data-catId="<%=list[i].catid%>">
										入场疯抢 >
									</button>
							 	</div>
							 	<div class="trangle"></div>
							</div>
							<!--二级分类-->
							<div class="npbk"> 
				 				<div class="secClassfy" onclick="goList(<%=list[i].catid%>)" data-pcatid="<%=list[i].catid%>"></div>
							</div>
						</div>
						<%}%>
				</script>
				 <script type="text/html" id="secClassfyTpl">
				 	<ul>
				 		<li style="border-left: 2px solid orangered;padding-left: 4px;color: orangered;font-size: 0.14rem;"><%=catname%></li><br />
				 		<%for(var i=0;i<list.length;i++){%>
							<li data-secid="<%=list[i].catid%>" onclick="goList(<%=list[i].catid%>)"><%=list[i].catname%></li>
						<%}%>
					</ul> 
				 </script>
			</div>
		</div>
	<script src="../../js/app.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript">
		mui.plusReady(function(){
			var oldToken = plus.storage.getItem('oldToken');
			var pidd = plus.webview.currentWebview().pid; 
			//获取 一级分类
			mui.ajax(serverUrl+'/api/mall/igocategory',{
				data:{pid:0},
				dataType:'json',
				type:'post',
				timeout:10000,
				headers:{"token":oldToken},	 
				success:function(data,type,xhr){
					console.log("一级分类",JSON.stringify(data))  
					if(data.errno == 0){
						if(data.data.length != 0){
							var tyepdata ={};
							tyepdata.myUrl = serverimgUrl;
							tyepdata.list = data.data;
							var html=template("classifyTpl",tyepdata);
							document.getElementById("classify").innerHTML=html; 
							document.getElementById(pidd).scrollIntoView();
							//请求二级分类
							var secClassfys = document.getElementsByClassName("secClassfy");
							//需用for循环 调用方法名传值  用each或者在for循环里面写方法都不可行 因为ajax异步 each直接拿到最后一个	
							for(var i = 0;i< secClassfys.length;i++){ 
								var pid = secClassfys[i].getAttribute("data-pcatid"); 
								console.log("pid ",pid)
						        getsecid(pid,i);
							}
						}
					}
				},
				error:function(xhr,type,errorThrown){
					plus.nativeUI.closeWaiting();//关闭等待框
					mui("#upload")[0].innerHTML = ""; 
					mui('#nulldiv')[0].style.display = 'block';
				}
			});
			//获取二级分类
			function getsecid(pid,i){
				mui.ajax(serverUrl+'/api/mall/igocategory',{
					data:{pid:pid},
					dataType:'json',
					type:'post',
					timeout:10000,
					headers:{"token":oldToken},	 
					success:function(data,type,xhr){ 
						if(data.errno == 0){
							if(data.data.length != 0){
								//请求三级分类 
								for(var j=0;j<data.data.length;j++){
									getthird(data.data[j].catid,data.data[j].catname,i)
								}
//								var tyepdata ={};
//								tyepdata.list = data.data;
//								var html=template("secClassfyTpl",tyepdata);
//								document.getElementsByClassName("secClassfy")[i].innerHTML = html;
							}
						}
					},
					error:function(xhr,type,errorThrown){
						plus.nativeUI.closeWaiting();//关闭等待框 
					}
				})
			}
			
			//三级分类
			function getthird(catid,catname,i){
				mui.ajax(serverUrl+'/api/mall/igocategory',{
					data:{pid:catid},
					dataType:'json',
					type:'post',
					timeout:10000,
					headers:{"token":oldToken},	 
					success:function(data,type,xhr){ 
						if(data.errno == 0){ 
							if(data.data.length != 0){ 
								var tyepdata ={};
								tyepdata.catname =catname;
								tyepdata.list = data.data;
								var html=template("secClassfyTpl",tyepdata);
								document.getElementsByClassName("secClassfy")[i].innerHTML+= html;
								 
							}
						}
					},
					error:function(xhr,type,errorThrown){
						plus.nativeUI.closeWaiting();//关闭等待框 
					}
				})
			}
			
			//进入列表
			window.goList = function(pid){
				event.stopPropagation();
				openview({
				 	view:"loveBuyList.html",
				 	extrasobj:{pid:pid}
				 })
			}
		})
	</script>
	</body>
	
</html>